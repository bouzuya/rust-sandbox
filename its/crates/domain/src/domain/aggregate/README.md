# aggregate

集約 (aggregate) は……

- ドメインレイヤーの外部に公開する API である
  - 集約
  - 集約コマンド
  - 集約イベント
  - 集約エラー
  - 値オブジェクト (集約コマンド・集約イベントで使用されるもののみ)
- トランザクション関連関数を持つ
  - 強い整合性 (DB トランザクション) の単位である
    - DB トランザクションの制御自体は外部に委ねる
  - 集約コマンドを引数に取り集約イベントを戻り値として返す
  - 同一の引数からは一定の戻り値を返す
  - トレイト経由を含む副作用のある操作を含まない
- リポジトリによる I/O の単位である
- 集約イベントは変更後の aggregate を含まない
  - 現状 集約コマンドはトランザクション関連関数がメソッドでないため対象の aggregate を含む
- TODO: I/O のための DTO の考慮
